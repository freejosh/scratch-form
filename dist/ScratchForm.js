(function(g,f){if(typeof exports=="object"&&typeof module<"u"){module.exports=f()}else if("function"==typeof define && define.amd){define("ScratchForm",f)}else {g["ScratchForm"]=f()}}(typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : this,function(){var exports={};var __exports=exports;var module={exports};
"use strict";var N=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var M=(e,t)=>{for(var n in t)N(e,n,{get:t[n],enumerable:!0})},S=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of C(t))!H.call(e,a)&&a!==n&&N(e,a,{get:()=>t[a],enumerable:!(r=k(t,a))||r.enumerable});return e};var V=e=>S(N({},"__esModule",{value:!0}),e);var j={};M(j,{default:()=>P});module.exports=V(j);function T(e){let{type:t,value:n}=e;if(t==="checkbox"||t==="radio")return e.checked?n:void 0;if(t==="number"||t==="range")return parseFloat(n);if(t==="file"){let{files:r}=e;return r?.length?r:null}return n}function D(e,t){if(e.type==="checkbox"||e.type==="radio"){e.checked=!!t;return}e.value=String(t)}function b(e,t){e instanceof Element&&(e.hasAttribute("name")&&t.push(e),t.splice(t.length,0,...Array.from(e.querySelectorAll("[name]"))))}function A(e){let t={};return e.querySelectorAll('[name$="[]"]').forEach(n=>{let r=n.getAttribute("name");if(!r)return;let a=t[r];a||(a=[],t[r]=a),a.push(n)}),t}function F(e,t){let n=e.getAttribute("name"),r=-1;return n&&(r=t[n].findIndex(a=>a===e)),r===-1&&console.error(`Could not find index for node: ${e.outerHTML}`),r}function p(e){let t=e,n=[],r=e.indexOf("[");return r!==-1&&(t=e.slice(0,r),n=e.slice(r+1,-1).split("][")),n.unshift(t),n}function g(e){let[t,...n]=e;return n.length?`${t}[${n.join("][")}]`:t}function x(e,t,n,r=!1){let[a,...d]=p(t);if(d.length>0){e[a]||(/^[0-9]+$/.test(d[0])?e[a]=[]:e[a]={}),x(e[a],g(d),n,r);return}if(r){if(Array.isArray(e)){let f=parseInt(a,10);if(Number.isNaN(f))return;e.splice(f,1);return}delete e[a];return}e[a]=n}function O(e,t){let[n,...r]=p(t);return r.length>0?e[n]?O(e[n],g(r)):void 0:e[n]}function v(e,t){let[n,...r]=p(t);return r.length>0?e[n]?v(e[n],g(r)):!1:n in e}var I="_sf_";function $(e,t={}){let{onChange:n,event:r="input"}=t,a={},d={},f={set(i,o,l){let u=o.toString(),c=l,s;return u.startsWith(I)?(u=u.slice(I.length),{value:c,node:s}=l):(s=e.querySelector(`[name="${u}"]`)||void 0,s&&D(s,l)),x(i,u,c),n?.(u,c,s,i),!0},deleteProperty(i,o){let l=o.toString();return x(i,l,void 0,!0),n?.(l,void 0,void 0,i),!0},get:O,has:v},E=new Proxy(d,f),h=i=>{if(!i||!(i instanceof Element))return;let o=i.getAttribute("name");if(!o)return;let l=T(i);if(o.endsWith("[]")){let u=F(i,a);if(u===-1)return;o=`${o.slice(0,-2)}[${u}]`}E[`${I}${o}`]={value:l,node:i}};function L(){e.querySelectorAll("[name]").forEach(h)}return a=A(e),L(),e.addEventListener(r,i=>{h(i.target)}),e.addEventListener("reset",()=>{setTimeout(L,0)}),new MutationObserver(i=>{let o=[],l=[];i.forEach(({addedNodes:u,removedNodes:c,type:s,target:m})=>{s==="attributes"&&h(m),c.forEach(y=>b(y,o)),u.forEach(y=>b(y,l))}),o.forEach(u=>{let c=u.getAttribute("name");if(c){if(c.endsWith("[]")){let s=F(u,a);if(s===-1)return;let m=a[c];m.splice(s,1),m.length===0?c=c.slice(0,-2):c=`${c.slice(0,-2)}[${s}]`}delete E[c]}}),a=A(e),l.forEach(u=>{h(u)})}).observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),E}var P=$;module.exports=$;

if(__exports != exports)module.exports = exports;return module.exports}));
