(function(g,f){if(typeof exports=="object"&&typeof module<"u"){module.exports=f()}else if("function"==typeof define && define.amd){define("ScratchForm",f)}else {g["ScratchForm"]=f()}}(typeof globalThis < "u" ? globalThis : typeof self < "u" ? self : this,function(){var exports={};var __exports=exports;var module={exports};
function V(e){let{type:t,value:r}=e;return t==="checkbox"||t==="radio"?e.checked?r:void 0:t==="number"||t==="range"?parseFloat(r):t==="file"?e.files.length?e.files:null:r}function P(e,t){if(e.type==="checkbox"||e.type==="radio"){e.checked=!!t;return}e.value=t}function g(e,t){e.hasAttribute("name")&&t.push(e),t.splice(t.length,0,...e.querySelectorAll("[name]"))}function m(e){let t={};return e.querySelectorAll('[name$="[]"]').forEach(r=>{let n=t[r.name];n||(n=[],t[r.name]=n),n.push(r)}),t}function N(e,t){let r=t[e.name].findIndex(n=>n===e);return r===-1&&console.error(`Could not find index for node: ${e.outerHTML}`),r}function h(e){let t=e,r=[],n=e.indexOf("[");return n!==-1&&(t=e.slice(0,n),r=e.slice(n+1,-1).split("][")),r.unshift(t),r}function d(e){let[t,...r]=e;return r.length?`${t}[${r.join("][")}]`:t}function p(e,t,r,n=!1){let[o,...f]=h(t);if(f.length>0){e[o]||(/^[0-9]+$/.test(f[0])?e[o]=[]:e[o]={}),p(e[o],d(f),r,n);return}if(n){if(Array.isArray(e)){e.splice(o,1);return}delete e[o];return}e[o]=r}function $(e,t){let[r,...n]=h(t);return n.length>0?e[r]?$(e[r],d(n)):void 0:e[r]}function v(e,t){let[r,...n]=h(t);return n.length>0?e[r]?v(e[r],d(n)):!1:r in e}var A="_sf_";function F(e,t={}){let{onChange:r,event:n="input"}=t,o={},f={set(i,a,l){let c=a,s=l,u;return a.startsWith(A)?(c=a.slice(A.length),{value:s,node:u}=l):(u=e.querySelector(`[name="${c}"]`),u&&P(u,l)),p(i,c,s),r(c,s,u,i),!0},deleteProperty(i,a){return p(i,a,void 0,!0),r(a,void 0,void 0,i),!0},get:$,has:v},x=new Proxy(o,f),y=i=>{let{name:a}=i;if(!a)return;let l=V(i);if(a.endsWith("[]")){let c=N(i,this.arrayCache);if(c===-1)return;a=`${a.slice(0,-2)}[${c}]`}x[`${A}${a}`]={value:l,node:i}};function C(){e.querySelectorAll("[name]").forEach(y)}return this.arrayCache=m(e),C(),e.addEventListener(n,i=>{y(i.target)}),e.addEventListener("reset",()=>{setTimeout(C,0)}),new MutationObserver(i=>{let a=[],l=[];i.forEach(({addedNodes:c,removedNodes:s})=>{s.forEach(u=>g(u,a)),c.forEach(u=>g(u,l))}),a.forEach(c=>{let{name:s}=c;if(s.endsWith("[]")){let u=N(c,this.arrayCache);if(u===-1)return;let O=this.arrayCache[s];O.splice(u,1),O.length===0?s=s.slice(0,-2):s=`${s.slice(0,-2)}[${u}]`}delete x[s]}),this.arrayCache=m(e),l.forEach(c=>{y(c)})}).observe(e,{childList:!0,subtree:!0}),x}module.exports=F;

if(__exports != exports)module.exports = exports;return module.exports}));
